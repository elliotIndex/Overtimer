<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">

  <title>Overtimer</title>
  <link rel="stylesheet" href="assets/stylesheets/main.css">
  <link href='https://fonts.googleapis.com/css?family=Lato:400,100,300' rel='stylesheet' type='text/css'>

  <script src="jquery.js"></script>
  <script src="data_generator.js"></script>

  <link rel="shortcut icon" href="https://cdn4.iconfinder.com/data/icons/mosaicon-02/512/timer-512.png">
</head>

<body>

  <!-- Header -->

  <header class="primary-header container group">

    <h1 class="logo">
      <a id="main-logo" href="index.html">Overtimer</a>
    </h1>

    <nav class="nav primary-nav">
      <ul>
        <li><a href="index.html">Home</a></li>
      </ul>
    </nav>

  </header>

  <!-- Main Body -->
  <section class="primary-body">
    <section class="body-upper">
      <h2 class="body-header">
        Home Feed
      </h2>

      <btn class="Pause primary-button" onclick="pause()">
        Pause
      </btn>

      <btn class="start primary-button" onclick="start()">
        Start
      </btn>
    </section>


    <section class="time-display">
      <div class="hours time-text">00</div>
      <input id="inputHours" type="number" name="inputHours" min="0" max="59" placeholder="00">
      <char class="semicolon">:</char>
      <div class="minutes time-text">00</div>
      <input id="inputMins" type="number" name="inputMins"  min="0" max="59" placeholder="00">
      <char class="semicolon">:</char>
      <div class="seconds time-text">00</div>
      <input id="inputSecs" type="number" name="inputSecs"  min="0" max="59" placeholder="00">
    </section>
    <section class="time-input">
    </section>



    <script>

    var displayTime = function(hours, minutes, seconds) {
      $('.hours').text(runTime.hours);
      $('.minutes').text(runTime.minutes);
      $('.seconds').text(runTime.seconds);
    }

    var initializeTimeLeft = function () {
      runTime.seconds = +$("#inputSecs").val()%60;
      runTime.minutes = +$("#inputMins").val()%60;
      runTime.hours = +$("#inputHours").val();
    }

    var start = function () {
      $('.start').text('Cancel');
      $(".time-display").find("input").css("display", "none");
      $(".time-text").css("display", "inline");
      initializeTimeLeft();
      displayTime();
      resume();
    }

    var pause = function () {
      refresher = clearInterval(refresher);
    }

    var resume = function() {
      refresher = setInterval(refreshTime, 1000);
    }

    var refreshTime = function() {
      if (runTime.seconds == 0) {
        if (runTime.minutes == 0){
          if (runTime.hours == 0) {
            enterOverTime();
            runTime.seconds++;
          } else {
            runTime.hours--;
            runTime.minutes = 59;
            runTime.seconds = 59;
          }
        } else {
          runTime.minutes--;
          runTime.seconds = 59;
        }

      } else {
        runTime.seconds--;
      }
      displayTime();
    }

    var enterOverTime = function() {
      overTime = true;
      $("body").css("background", "red");
      $("body").css("background", " #9ad3de");
      $("body").css("background", "-webkit-linear-gradient(to right, #89bdd3, #9ad3de)");
      $("body").css("background", "-moz-linear-gradient(to right, #89bdd3, #9ad3de)");
      $("body").css("background", "linear-gradient(to right, #FF1111, #FF6666)");
      refresher = clearInterval(refresher);
      refresher = setInterval(refreshOverTime, 1000);
    }

    var refreshOverTime = function() {
      if (runTime.seconds == 59) {
        if (runTime.minutes == 59){
          runTime.hours++;
          runTime.minutes = 00;
          runTime.seconds = 00;
        } else {
          runTime.minutes++;
          runTime.seconds = 00;
        }
      } else {
        runTime.seconds++;
      }
      displayTime();
    }


    // Add 'enter' key funcitonality to time input
    $(".time-display").find("input").keyup(function(event){
      if(event.keyCode == 13){
        start();
      }
    });

    //////////////////////////////////////
    //            Main Script           //
    //////////////////////////////////////
    var inputHours = 1;
    var inputMins = 0;
    var inputSecs = 10;

    var runTime = { hours: 0,
      minutes: 0,
      seconds: 0 };

      var startTime;
      var endTime;
      var now = new Date;
      var running = false;
      var refresher;
      var overTime = false;

      $(document).ready();
      if (running) {};

      </script>

    </section>

    <!-- Footer -->

    <footer class="primary-footer container group">

      <small>&copy; Elliot Plant 2015</small>

      <nav class="nav">
        <ul>
          <li><a href="index.html">Home</a></li>
        </ul>
      </nav>

    </footer>

  </body>
  </html>
